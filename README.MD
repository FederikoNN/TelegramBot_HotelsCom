# **1. Настройка бота:**

1) Открыть файл *.env* из корневой папки с ботом
2) Изменить значения переменных:

- ADMINS - Телеграм ID админов, вводятся через запятую
- BOT_TOKEN - токен Телеграм бота (Можно получить после создания бота в боте @BotFather)
- RAPID_API_KEY - ключ для работы с АПИ, получить можно после регистрации на сайте
- ip - IP сервера, на котором будет работать бот

# **2. Требования:**

- Python 3.7 +
- aiogram 2.12 +
- environs 8.0 +
- requests
- pipenv

# **3. Взаимодействие бота с сервером Telegram:**

По умолчанию бот использует webhook для взаимодействия с сервером Telegram.

Для использования polling необходимо:

1. В файле /config.py закомментировать строки 14-24.
2. В файле /loader.py закомментировать строки 4, 6, 13-15.
3. В файле /main.py:

- закомментировать строки 4, 9, 16, 31-38;
- снять комментарии со строк 1, 30

# **4. Установка бота на сервер apache c Ubuntu 18+:**

1. Установка Docker - sudo apt install docker docker-compose -y
2. Копируем бота в выбранную папку на сервере либо клонируем из репозитория.
3. Копируем в корневую папку с ботом SSL-сертификат сервера и приватный ключ:

- при наличии SSL-сертификата сервера- копируем файлы сертификата и приватного ключа в папку с ботом и переименовываем
  их в webhook_cert.pem и webhook_pkey.pem соответственно.
- при отсутствии SSL-сертификата сервера- генерируем приватный ключ (команда: openssl genrsa -out webhook_pkey.pem 2048)
  и сертификат (команда: openssl req -new -x509 -days 3650 -key webhook_pkey.pem -out webhook_cert.pem).

# **5. Запуск бота на сервере:**

1. Запуск бота на сервере из корневой папки с ботом - sudo docker-compose up

# **6. Инструкция по использованию бота:**

/help — помощь по командам бота

/lowprice — вывод самых дешёвых отелей в городе

/highprice — вывод самых дорогих отелей в городе

/bestdeal — вывод отелей, наиболее подходящих по цене и расположению от центра

/history — вывод истории поиска отелей

# **7. Дополнение**

- просмотр всех логов в файле log-file.log
- данные о пользователях и истории поиска в файле БД main.db